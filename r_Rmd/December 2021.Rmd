---
title: "Advent of Code - December 2021"
output: 
  html_document:
    keep_md: true
    toc: true
    toc_float: true
knit: crsp::knit_to_outputs_folder
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  fig.retina = 3,
  fig.path = here::here("exports", "November", "/"),
  out.width = "100%"
)

knitr::opts_knit$set(
#  root.dir = here::here(),
  output.dir = here::here("html files")
)

# pacman::p_load(
# # import/cleaning
#   janitor, pacman, job, rio, skimr, here,
# 
# # stats/model summaries
#   easystats, rstatix, corrr, modelsummary,
# 
# # plotting
#   paletteer, gghalves, ggcorrplot, ggstatsplot, ggpubr, ggbeeswarm, 
# 
# # tables
#   flextable, gt,
# 
# # tidy/everything
#   tidyverse, crsp
# )

clean_names <- janitor::clean_names  # this is because both {insight} and {janitor} have a clean_names()


pacman::p_load(tidyverse, emo, pacman, flextable, rio, here, adventdrob)

theme_set(theme_bw(base_size = 15) + theme(legend.position = "bottom"))

```

```{r aoc-data-pull, include = FALSE}
#browseURL("https://colin-fraser.net/post/a-quick-tutorial-on-importing-data-from-advent-of-code-into-r/")

p_load(glue, httr)


aoc_build_url <- function(day, year = 2021) {
  formatted_url <- glue("adventofcode.com/{year}/day/{day}/input")
  return(formatted_url)
}

aoc_get_response <- function(day, 
                             session_cookie = rstudioapi::askForSecret("AoC Session Cookie"), 
                             year = 2021) {
  aoc_url <- aoc_build_url(day, year)
  cookie <- set_cookies(session = session_cookie)
  response <- GET(aoc_url, cookie)
  return(response)
}

# test <- aoc_get_response(1) %>% 
#   content(encoding = 'UTF-8') %>% 
#   read_lines() %>% 
#   as.numeric()

```

The [Advent of Code](https://adventofcode.com/) is a daily challenge
series that has two puzzles each day. You get a star for each puzzle
solved. Try to get all 50!

# Introduction

You're minding your own business on a ship at sea when the overboard
alarm goes off! You rush to see if you can help. Apparently, one of the
Elves tripped and accidentally sent the sleigh keys flying into the
ocean!

Before you know it, you're inside a submarine the Elves keep ready for
situations like this. It's covered in Christmas lights (because of
course it is), and it even has an experimental antenna that should be
able to track the keys if you can boost its signal strength high enough;
there's a little meter that indicates the antenna's signal strength by
displaying 0-50 stars.

Your instincts tell you that in order to save Christmas, you'll need to
get all fifty stars by December 25th.

Collect stars by solving puzzles. Two puzzles will be made available on
each day in the Advent calendar; the second puzzle is unlocked when you
complete the first. Each puzzle grants one star. Good luck!

As the submarine drops below the surface of the ocean, it automatically
performs a sonar sweep of the nearby sea floor. On a small screen, the
sonar sweep report (your puzzle input) appears: each line is a
measurement of the sea floor depth as the sweep looks further and
further away from the submarine.

# Day 1: Sonar Sweep

The first order of business is to figure out how quickly the depth
increases, just so you know what you're dealing with - you never know if
the keys will get carried into deeper water by an ocean current or a
fish or something.

## Puzzle 1

To do this, count the number of times a depth measurement increases from
the previous measurement. (There is no measurement before the first
measurement.)

```{r day-1-data, include = FALSE}
depth <- tibble::tribble(
           ~depth,
             199L,
             227L,
             229L,
             230L,
             233L,
             228L,
             231L,
             226L,
             237L,
             259L,
             262L,
             265L,
             266L,
             265L,
             269L,
             276L,
             278L,
             279L,
             281L,
             287L,
             305L,
             316L,
             314L,
             320L,
             313L,
             314L,
             315L,
             329L,
             346L,
             357L,
             370L,
             369L,
             360L,
             384L,
             383L,
             401L,
             402L,
             403L,
             404L,
             403L,
             406L,
             408L,
             406L,
             401L,
             393L,
             395L,
             416L,
             418L,
             408L,
             411L,
             412L,
             416L,
             417L,
             404L,
             421L,
             436L,
             437L,
             436L,
             420L,
             388L,
             405L,
             403L,
             371L,
             376L,
             378L,
             374L,
             378L,
             377L,
             403L,
             411L,
             444L,
             424L,
             417L,
             416L,
             419L,
             436L,
             415L,
             413L,
             429L,
             446L,
             462L,
             463L,
             464L,
             467L,
             466L,
             475L,
             483L,
             478L,
             487L,
             488L,
             469L,
             470L,
             472L,
             473L,
             460L,
             463L,
             465L,
             477L,
             487L,
             508L,
             506L,
             509L,
             512L,
             513L,
             519L,
             525L,
             531L,
             498L,
             506L,
             504L,
             506L,
             507L,
             509L,
             510L,
             512L,
             537L,
             553L,
             536L,
             533L,
             524L,
             525L,
             526L,
             527L,
             530L,
             531L,
             533L,
             537L,
             538L,
             537L,
             539L,
             544L,
             552L,
             550L,
             576L,
             560L,
             556L,
             561L,
             552L,
             560L,
             572L,
             573L,
             572L,
             571L,
             573L,
             578L,
             581L,
             582L,
             578L,
             541L,
             546L,
             537L,
             545L,
             556L,
             565L,
             566L,
             571L,
             561L,
             573L,
             579L,
             578L,
             581L,
             600L,
             603L,
             604L,
             597L,
             598L,
             599L,
             598L,
             599L,
             580L,
             585L,
             586L,
             596L,
             597L,
             602L,
             593L,
             598L,
             599L,
             604L,
             608L,
             609L,
             616L,
             615L,
             613L,
             622L,
             625L,
             620L,
             632L,
             636L,
             628L,
             633L,
             640L,
             621L,
             620L,
             638L,
             646L,
             647L,
             648L,
             647L,
             654L,
             655L,
             663L,
             652L,
             664L,
             668L,
             669L,
             668L,
             663L,
             667L,
             659L,
             658L,
             666L,
             670L,
             685L,
             703L,
             706L,
             705L,
             706L,
             727L,
             730L,
             729L,
             735L,
             743L,
             749L,
             750L,
             751L,
             756L,
             774L,
             776L,
             767L,
             778L,
             777L,
             790L,
             791L,
             794L,
             798L,
             801L,
             804L,
             812L,
             818L,
             819L,
             818L,
             821L,
             825L,
             818L,
             829L,
             832L,
             835L,
             849L,
             848L,
             863L,
             859L,
             863L,
             871L,
             870L,
             869L,
             873L,
             875L,
             878L,
             874L,
             896L,
             903L,
             890L,
             891L,
             905L,
             912L,
             913L,
             911L,
             917L,
             941L,
             943L,
             944L,
             940L,
             943L,
             945L,
             947L,
             948L,
             953L,
             930L,
             932L,
             933L,
             948L,
             936L,
             937L,
             941L,
             947L,
             952L,
             957L,
             951L,
             953L,
             954L,
             958L,
             979L,
             982L,
             971L,
             974L,
             979L,
             984L,
             988L,
             989L,
             986L,
             987L,
             992L,
             998L,
            1013L,
            1024L,
            1022L,
            1023L,
            1014L,
            1019L,
            1042L,
            1048L,
            1047L,
            1060L,
            1056L,
            1067L,
            1054L,
            1053L,
            1061L,
            1063L,
            1068L,
            1074L,
            1104L,
            1105L,
            1107L,
            1119L,
            1126L,
            1127L,
            1129L,
            1143L,
            1145L,
            1146L,
            1151L,
            1159L,
            1183L,
            1185L,
            1192L,
            1183L,
            1185L,
            1182L,
            1180L,
            1198L,
            1215L,
            1221L,
            1224L,
            1227L,
            1230L,
            1262L,
            1289L,
            1291L,
            1294L,
            1297L,
            1300L,
            1303L,
            1321L,
            1323L,
            1329L,
            1331L,
            1341L,
            1362L,
            1369L,
            1370L,
            1388L,
            1389L,
            1393L,
            1407L,
            1386L,
            1380L,
            1381L,
            1378L,
            1398L,
            1402L,
            1399L,
            1422L,
            1433L,
            1449L,
            1451L,
            1449L,
            1462L,
            1454L,
            1455L,
            1452L,
            1471L,
            1472L,
            1487L,
            1477L,
            1459L,
            1463L,
            1461L,
            1463L,
            1473L,
            1489L,
            1482L,
            1516L,
            1527L,
            1521L,
            1522L,
            1527L,
            1529L,
            1531L,
            1538L,
            1550L,
            1553L,
            1548L,
            1549L,
            1545L,
            1548L,
            1543L,
            1546L,
            1549L,
            1572L,
            1576L,
            1581L,
            1575L,
            1584L,
            1602L,
            1604L,
            1605L,
            1606L,
            1611L,
            1610L,
            1623L,
            1618L,
            1614L,
            1622L,
            1613L,
            1608L,
            1611L,
            1638L,
            1632L,
            1643L,
            1649L,
            1652L,
            1655L,
            1652L,
            1653L,
            1654L,
            1658L,
            1659L,
            1661L,
            1667L,
            1695L,
            1710L,
            1719L,
            1726L,
            1727L,
            1725L,
            1726L,
            1736L,
            1741L,
            1763L,
            1752L,
            1769L,
            1770L,
            1767L,
            1768L,
            1769L,
            1771L,
            1799L,
            1798L,
            1810L,
            1813L,
            1816L,
            1826L,
            1837L,
            1842L,
            1841L,
            1848L,
            1853L,
            1823L,
            1836L,
            1835L,
            1837L,
            1836L,
            1839L,
            1838L,
            1840L,
            1841L,
            1839L,
            1843L,
            1844L,
            1862L,
            1873L,
            1877L,
            1880L,
            1882L,
            1881L,
            1895L,
            1891L,
            1896L,
            1899L,
            1893L,
            1894L,
            1892L,
            1894L,
            1895L,
            1921L,
            1920L,
            1922L,
            1928L,
            1925L,
            1933L,
            1943L,
            1942L,
            1936L,
            1941L,
            1919L,
            1912L,
            1914L,
            1922L,
            1918L,
            1934L,
            1932L,
            1946L,
            1949L,
            1955L,
            1964L,
            1974L,
            1977L,
            1978L,
            1983L,
            1984L,
            1986L,
            1990L,
            2005L,
            2022L,
            2026L,
            2032L,
            2031L,
            2029L,
            2031L,
            2035L,
            2041L,
            2042L,
            2043L,
            2053L,
            2054L,
            2058L,
            2062L,
            2063L,
            2055L,
            2049L,
            2021L,
            2022L,
            2054L,
            2052L,
            2084L,
            2076L,
            2079L,
            2090L,
            2088L,
            2093L,
            2095L,
            2093L,
            2091L,
            2089L,
            2095L,
            2096L,
            2102L,
            2127L,
            2129L,
            2132L,
            2117L,
            2125L,
            2131L,
            2132L,
            2126L,
            2134L,
            2140L,
            2137L,
            2138L,
            2136L,
            2137L,
            2141L,
            2153L,
            2152L,
            2170L,
            2177L,
            2147L,
            2159L,
            2161L,
            2160L,
            2173L,
            2176L,
            2194L,
            2205L,
            2206L,
            2213L,
            2231L,
            2232L,
            2242L,
            2243L,
            2217L,
            2224L,
            2225L,
            2230L,
            2226L,
            2214L,
            2212L,
            2227L,
            2230L,
            2237L,
            2238L,
            2241L,
            2264L,
            2283L,
            2288L,
            2308L,
            2309L,
            2311L,
            2312L,
            2314L,
            2316L,
            2317L,
            2318L,
            2321L,
            2326L,
            2324L,
            2325L,
            2321L,
            2324L,
            2322L,
            2325L,
            2327L,
            2335L,
            2369L,
            2370L,
            2374L,
            2375L,
            2344L,
            2347L,
            2348L,
            2341L,
            2346L,
            2355L,
            2356L,
            2371L,
            2368L,
            2370L,
            2375L,
            2378L,
            2379L,
            2370L,
            2363L,
            2365L,
            2366L,
            2363L,
            2364L,
            2372L,
            2374L,
            2392L,
            2399L,
            2397L,
            2384L,
            2400L,
            2401L,
            2402L,
            2401L,
            2400L,
            2402L,
            2412L,
            2422L,
            2423L,
            2426L,
            2424L,
            2425L,
            2421L,
            2422L,
            2440L,
            2441L,
            2451L,
            2442L,
            2443L,
            2444L,
            2446L,
            2451L,
            2452L,
            2450L,
            2458L,
            2457L,
            2490L,
            2496L,
            2506L,
            2507L,
            2508L,
            2511L,
            2531L,
            2536L,
            2537L,
            2539L,
            2529L,
            2530L,
            2561L,
            2562L,
            2592L,
            2595L,
            2584L,
            2601L,
            2603L,
            2589L,
            2586L,
            2588L,
            2586L,
            2596L,
            2613L,
            2616L,
            2618L,
            2621L,
            2629L,
            2637L,
            2638L,
            2619L,
            2621L,
            2619L,
            2631L,
            2621L,
            2619L,
            2624L,
            2628L,
            2634L,
            2636L,
            2637L,
            2626L,
            2632L,
            2623L,
            2630L,
            2629L,
            2630L,
            2633L,
            2620L,
            2629L,
            2635L,
            2614L,
            2617L,
            2612L,
            2613L,
            2609L,
            2601L,
            2604L,
            2611L,
            2602L,
            2607L,
            2611L,
            2639L,
            2646L,
            2647L,
            2618L,
            2613L,
            2614L,
            2635L,
            2642L,
            2649L,
            2653L,
            2652L,
            2628L,
            2629L,
            2631L,
            2636L,
            2639L,
            2649L,
            2665L,
            2667L,
            2666L,
            2665L,
            2668L,
            2672L,
            2673L,
            2675L,
            2693L,
            2694L,
            2696L,
            2701L,
            2702L,
            2703L,
            2700L,
            2716L,
            2718L,
            2719L,
            2718L,
            2719L,
            2722L,
            2723L,
            2715L,
            2726L,
            2737L,
            2757L,
            2758L,
            2759L,
            2762L,
            2760L,
            2765L,
            2759L,
            2763L,
            2764L,
            2774L,
            2785L,
            2786L,
            2802L,
            2803L,
            2802L,
            2824L,
            2833L,
            2834L,
            2830L,
            2832L,
            2842L,
            2828L,
            2829L,
            2836L,
            2838L,
            2813L,
            2811L,
            2798L,
            2799L,
            2796L,
            2805L,
            2808L,
            2807L,
            2811L,
            2812L,
            2811L,
            2812L,
            2793L,
            2787L,
            2802L,
            2805L,
            2804L,
            2822L,
            2825L,
            2837L,
            2835L,
            2842L,
            2838L,
            2849L,
            2840L,
            2841L,
            2853L,
            2854L,
            2863L,
            2877L,
            2886L,
            2864L,
            2866L,
            2846L,
            2860L,
            2840L,
            2842L,
            2844L,
            2866L,
            2867L,
            2870L,
            2856L,
            2860L,
            2861L,
            2860L,
            2872L,
            2877L,
            2881L,
            2883L,
            2881L,
            2883L,
            2880L,
            2881L,
            2882L,
            2880L,
            2902L,
            2903L,
            2904L,
            2937L,
            2939L,
            2938L,
            2945L,
            2954L,
            2950L,
            2966L,
            2967L,
            2976L,
            2980L,
            2982L,
            2976L,
            2986L,
            2997L,
            2996L,
            2994L,
            3004L,
            3007L,
            3008L,
            3016L,
            3014L,
            3054L,
            3078L,
            3095L,
            3114L,
            3115L,
            3120L,
            3107L,
            3109L,
            3124L,
            3140L,
            3144L,
            3150L,
            3163L,
            3165L,
            3164L,
            3158L,
            3172L,
            3175L,
            3174L,
            3184L,
            3188L,
            3198L,
            3193L,
            3224L,
            3226L,
            3227L,
            3252L,
            3273L,
            3280L,
            3289L,
            3291L,
            3290L,
            3291L,
            3279L,
            3281L,
            3282L,
            3281L,
            3298L,
            3302L,
            3289L,
            3304L,
            3295L,
            3312L,
            3314L,
            3327L,
            3328L,
            3337L,
            3348L,
            3349L,
            3340L,
            3348L,
            3351L,
            3350L,
            3351L,
            3350L,
            3345L,
            3339L,
            3343L,
            3344L,
            3329L,
            3354L,
            3356L,
            3358L,
            3363L,
            3365L,
            3373L,
            3376L,
            3383L,
            3384L,
            3388L,
            3389L,
            3390L,
            3397L,
            3398L,
            3401L,
            3409L,
            3411L,
            3412L,
            3411L,
            3418L,
            3428L,
            3430L,
            3432L,
            3418L,
            3410L,
            3418L,
            3424L,
            3425L,
            3426L,
            3430L,
            3439L,
            3441L,
            3422L,
            3423L,
            3425L,
            3426L,
            3428L,
            3429L,
            3436L,
            3448L,
            3447L,
            3443L,
            3445L,
            3468L,
            3482L,
            3483L,
            3499L,
            3506L,
            3513L,
            3518L,
            3523L,
            3524L,
            3525L,
            3529L,
            3532L,
            3529L,
            3565L,
            3577L,
            3576L,
            3577L,
            3576L,
            3539L,
            3557L,
            3554L,
            3563L,
            3562L,
            3564L,
            3565L,
            3586L,
            3583L,
            3590L,
            3589L,
            3580L,
            3581L,
            3574L,
            3599L,
            3597L,
            3609L,
            3610L,
            3611L,
            3614L,
            3613L,
            3611L,
            3612L,
            3611L,
            3598L,
            3596L,
            3597L,
            3585L,
            3568L,
            3569L,
            3550L,
            3561L,
            3563L,
            3551L,
            3552L,
            3555L,
            3553L,
            3554L,
            3553L,
            3552L,
            3555L,
            3557L,
            3560L,
            3585L,
            3591L,
            3604L,
            3609L,
            3640L,
            3641L,
            3645L,
            3644L,
            3643L,
            3646L,
            3644L,
            3664L,
            3653L,
            3660L,
            3667L,
            3664L,
            3665L,
            3668L,
            3670L,
            3649L,
            3640L,
            3639L,
            3647L,
            3654L,
            3650L,
            3648L,
            3654L,
            3651L,
            3652L,
            3653L,
            3654L,
            3655L,
            3671L,
            3660L,
            3671L,
            3675L,
            3679L,
            3680L,
            3681L,
            3686L,
            3690L,
            3691L,
            3693L,
            3695L,
            3698L,
            3697L,
            3699L,
            3708L,
            3712L,
            3714L,
            3712L,
            3711L,
            3716L,
            3731L,
            3732L,
            3736L,
            3753L,
            3755L,
            3756L,
            3767L,
            3747L,
            3746L,
            3733L,
            3711L,
            3722L,
            3718L,
            3721L,
            3722L,
            3723L,
            3724L,
            3727L,
            3731L,
            3732L,
            3741L,
            3743L,
            3750L,
            3751L,
            3738L,
            3741L,
            3739L,
            3740L,
            3756L,
            3755L,
            3751L,
            3750L,
            3755L,
            3757L,
            3773L,
            3778L,
            3781L,
            3782L,
            3768L,
            3772L,
            3766L,
            3770L,
            3778L,
            3792L,
            3798L,
            3801L,
            3803L,
            3801L,
            3812L,
            3833L,
            3873L,
            3868L,
            3865L,
            3866L,
            3906L,
            3910L,
            3897L,
            3907L,
            3910L,
            3898L,
            3914L,
            3917L,
            3908L,
            3912L,
            3920L,
            3934L,
            3930L,
            3934L,
            3935L,
            3937L,
            3942L,
            3943L,
            3948L,
            3964L,
            3978L,
            3985L,
            3986L,
            3993L,
            3995L,
            4014L,
            4021L,
            4024L,
            4025L,
            4024L,
            4027L,
            4028L,
            4043L,
            4047L,
            4049L,
            4036L,
            4039L,
            4038L,
            4037L,
            4045L,
            4040L,
            4041L,
            4043L,
            4035L,
            4046L,
            4063L,
            4054L,
            4055L,
            4064L,
            4067L,
            4060L,
            4061L,
            4062L,
            4069L,
            4070L,
            4063L,
            4064L,
            4077L,
            4065L,
            4074L,
            4076L,
            4078L,
            4091L,
            4100L,
            4104L,
            4105L,
            4106L,
            4107L,
            4115L,
            4110L,
            4112L,
            4113L,
            4114L,
            4115L,
            4092L,
            4093L,
            4107L,
            4109L,
            4108L,
            4112L,
            4143L,
            4144L,
            4145L,
            4146L,
            4145L,
            4144L,
            4126L,
            4130L,
            4134L,
            4149L,
            4151L,
            4161L,
            4162L,
            4160L,
            4146L,
            4170L,
            4188L,
            4196L,
            4194L,
            4193L,
            4196L,
            4197L,
            4198L,
            4200L,
            4205L,
            4218L,
            4228L,
            4216L,
            4224L,
            4226L,
            4241L,
            4245L,
            4247L,
            4251L,
            4245L,
            4244L,
            4266L,
            4259L,
            4262L,
            4269L,
            4270L,
            4275L,
            4281L,
            4298L,
            4305L,
            4309L,
            4311L,
            4325L,
            4328L,
            4346L,
            4347L,
            4357L,
            4360L,
            4359L,
            4357L,
            4391L,
            4396L,
            4391L,
            4397L,
            4395L,
            4405L,
            4410L,
            4412L,
            4433L,
            4420L,
            4421L,
            4422L,
            4423L,
            4431L,
            4437L,
            4447L,
            4451L,
            4458L,
            4457L,
            4458L,
            4456L,
            4455L,
            4458L,
            4460L,
            4431L,
            4432L,
            4431L,
            4441L,
            4444L,
            4436L,
            4408L,
            4406L,
            4414L,
            4415L,
            4413L,
            4422L,
            4449L,
            4430L,
            4428L,
            4397L,
            4395L,
            4396L,
            4398L,
            4396L,
            4399L,
            4406L,
            4413L,
            4422L,
            4421L,
            4429L,
            4431L,
            4430L,
            4462L,
            4460L,
            4480L,
            4482L,
            4486L,
            4484L,
            4483L,
            4497L,
            4493L,
            4496L,
            4506L,
            4504L,
            4497L,
            4498L,
            4503L,
            4513L,
            4525L,
            4533L,
            4547L,
            4560L,
            4561L,
            4563L,
            4562L,
            4572L,
            4571L,
            4575L,
            4557L,
            4561L,
            4562L,
            4550L,
            4552L,
            4543L,
            4537L,
            4534L,
            4542L,
            4561L,
            4563L,
            4562L,
            4583L,
            4582L,
            4591L,
            4592L,
            4597L,
            4601L,
            4599L,
            4600L,
            4610L,
            4601L,
            4612L,
            4630L,
            4616L,
            4619L,
            4623L,
            4624L,
            4636L,
            4638L,
            4645L,
            4651L,
            4655L,
            4660L,
            4659L,
            4658L,
            4657L,
            4658L,
            4661L,
            4670L,
            4665L,
            4656L,
            4664L,
            4666L,
            4667L,
            4669L,
            4696L,
            4701L,
            4712L,
            4711L,
            4719L,
            4679L,
            4680L,
            4686L,
            4684L,
            4685L,
            4689L,
            4682L,
            4686L,
            4688L,
            4687L,
            4688L,
            4687L,
            4693L,
            4672L,
            4670L,
            4667L,
            4673L,
            4643L,
            4644L,
            4653L,
            4668L,
            4669L,
            4672L,
            4685L,
            4663L,
            4665L,
            4672L,
            4696L,
            4698L,
            4701L,
            4699L,
            4687L,
            4690L,
            4687L,
            4684L,
            4685L,
            4687L,
            4689L,
            4685L,
            4692L,
            4690L,
            4696L,
            4702L,
            4703L,
            4704L,
            4717L,
            4718L,
            4719L,
            4711L,
            4717L,
            4719L,
            4726L,
            4722L,
            4736L,
            4735L,
            4739L,
            4748L,
            4741L,
            4738L,
            4736L,
            4737L,
            4736L,
            4740L,
            4748L,
            4749L,
            4757L,
            4760L,
            4768L,
            4754L,
            4756L,
            4772L,
            4773L,
            4775L,
            4770L,
            4766L,
            4769L,
            4762L,
            4771L,
            4773L,
            4775L,
            4776L,
            4778L,
            4782L,
            4770L,
            4763L,
            4765L,
            4764L,
            4765L,
            4764L,
            4777L,
            4780L,
            4786L,
            4797L,
            4803L,
            4812L,
            4811L,
            4818L,
            4823L,
            4820L,
            4821L,
            4831L,
            4834L,
            4862L,
            4865L,
            4856L,
            4857L,
            4863L,
            4860L,
            4861L,
            4858L,
            4846L,
            4848L,
            4852L,
            4853L,
            4854L,
            4856L,
            4832L,
            4833L,
            4832L,
            4830L,
            4826L,
            4833L,
            4851L,
            4852L,
            4855L,
            4856L,
            4857L,
            4852L,
            4854L,
            4860L,
            4863L,
            4887L,
            4878L,
            4879L,
            4880L,
            4893L,
            4888L,
            4891L,
            4892L,
            4896L,
            4897L,
            4900L,
            4905L,
            4903L,
            4909L,
            4927L,
            4942L,
            4946L,
            4952L,
            4970L,
            4971L,
            4987L,
            4990L,
            4991L,
            4990L,
            4989L,
            4988L,
            4989L,
            4995L,
            4996L,
            5004L,
            5003L,
            5005L,
            5009L,
            4997L,
            4981L,
            4977L,
            4979L,
            4982L,
            4984L,
            4994L,
            5005L,
            5009L,
            5008L,
            5036L,
            5034L,
            5033L,
            5030L,
            5032L,
            5034L,
            5030L,
            5031L,
            5034L,
            5070L,
            5072L,
            5071L,
            5073L,
            5077L,
            5078L,
            5070L,
            5084L,
            5085L,
            5091L,
            5071L,
            5080L,
            5075L,
            5070L,
            5067L,
            5072L,
            5075L,
            5082L,
            5085L,
            5091L,
            5104L,
            5120L,
            5123L,
            5122L,
            5105L,
            5120L,
            5128L,
            5116L,
            5118L,
            5122L,
            5120L,
            5140L,
            5142L,
            5145L,
            5148L,
            5152L,
            5153L,
            5154L,
            5157L,
            5172L,
            5179L,
            5177L,
            5185L,
            5191L,
            5200L,
            5201L,
            5207L,
            5205L,
            5206L,
            5198L,
            5205L,
            5186L,
            5188L,
            5197L,
            5194L,
            5203L,
            5204L,
            5205L,
            5208L,
            5214L,
            5220L,
            5219L,
            5224L,
            5227L,
            5241L,
            5233L,
            5253L,
            5283L,
            5287L,
            5291L,
            5289L,
            5296L,
            5297L,
            5294L,
            5288L,
            5289L,
            5290L,
            5278L,
            5290L,
            5288L,
            5294L,
            5295L,
            5294L,
            5292L,
            5289L,
            5299L,
            5283L,
            5285L,
            5290L,
            5289L,
            5291L,
            5302L,
            5304L,
            5305L,
            5315L,
            5316L,
            5323L,
            5337L,
            5341L,
            5345L,
            5346L,
            5358L,
            5361L,
            5367L,
            5348L,
            5354L,
            5344L,
            5339L,
            5342L,
            5341L,
            5354L,
            5356L,
            5355L,
            5354L,
            5355L,
            5356L,
            5342L,
            5348L,
            5350L,
            5351L,
            5355L,
            5378L,
            5380L,
            5404L,
            5405L,
            5407L,
            5417L,
            5419L,
            5411L,
            5412L,
            5413L,
            5416L,
            5420L,
            5391L,
            5377L,
            5386L,
            5387L,
            5390L,
            5383L,
            5385L,
            5384L,
            5390L,
            5389L,
            5390L,
            5409L,
            5414L,
            5424L,
            5427L,
            5428L,
            5430L,
            5443L,
            5435L,
            5430L,
            5427L,
            5428L,
            5422L,
            5452L,
            5460L,
            5464L,
            5465L,
            5472L,
            5473L,
            5481L,
            5480L,
            5481L,
            5482L,
            5483L,
            5493L,
            5495L,
            5492L,
            5501L,
            5517L,
            5519L,
            5527L,
            5532L,
            5529L,
            5532L,
            5542L,
            5532L,
            5550L,
            5551L,
            5560L,
            5543L,
            5549L,
            5555L,
            5554L,
            5555L,
            5552L,
            5562L,
            5563L,
            5564L,
            5566L,
            5568L,
            5571L,
            5549L,
            5556L,
            5557L,
            5563L,
            5564L,
            5567L,
            5563L,
            5570L,
            5559L,
            5580L,
            5585L,
            5568L,
            5569L,
            5562L,
            5578L,
            5579L,
            5565L,
            5567L,
            5583L,
            5584L,
            5592L,
            5590L,
            5593L,
            5595L,
            5594L,
            5597L,
            5582L,
            5588L,
            5594L,
            5596L,
            5598L,
            5597L,
            5595L,
            5605L,
            5593L,
            5590L,
            5599L,
            5603L,
            5597L,
            5632L,
            5621L,
            5624L,
            5628L,
            5634L,
            5662L,
            5663L,
            5666L,
            5674L,
            5678L,
            5677L,
            5678L,
            5679L,
            5680L,
            5681L,
            5687L,
            5690L,
            5685L,
            5684L,
            5683L,
            5689L,
            5690L,
            5691L,
            5689L,
            5694L,
            5698L,
            5701L,
            5698L,
            5733L,
            5757L,
            5767L,
            5794L,
            5812L,
            5804L,
            5802L,
            5810L,
            5826L,
            5856L,
            5855L,
            5860L,
            5861L,
            5846L,
            5865L,
            5885L,
            5874L,
            5883L,
            5888L,
            5892L,
            5894L,
            5877L,
            5840L,
            5841L,
            5814L,
            5815L,
            5818L,
            5821L,
            5822L,
            5819L,
            5818L,
            5842L,
            5849L,
            5850L,
            5851L,
            5854L,
            5856L,
            5854L,
            5851L,
            5864L,
            5866L,
            5867L,
            5871L,
            5874L,
            5879L,
            5888L,
            5886L,
            5890L,
            5894L,
            5889L,
            5875L,
            5863L,
            5847L,
            5857L,
            5853L,
            5858L,
            5859L,
            5862L,
            5867L,
            5862L,
            5866L,
            5874L,
            5875L,
            5894L,
            5897L,
            5877L,
            5886L,
            5887L,
            5891L,
            5881L,
            5886L,
            5885L,
            5886L,
            5887L,
            5888L,
            5892L,
            5891L,
            5903L,
            5902L,
            5901L,
            5902L,
            5903L,
            5908L,
            5905L,
            5912L,
            5914L,
            5920L,
            5927L,
            5916L,
            5917L,
            5918L,
            5921L,
            5931L,
            5939L,
            5942L,
            5943L,
            5949L,
            5962L,
            5990L,
            5985L,
            5982L,
            5980L,
            5979L,
            5990L,
            5995L,
            6012L,
            6029L,
            6038L,
            6050L,
            6051L,
            6057L,
            6052L,
            6061L,
            6060L,
            6050L,
            6058L,
            6059L,
            6060L,
            6064L,
            6065L,
            6092L,
            6091L,
            6090L,
            6089L,
            6085L,
            6101L,
            6107L,
            6110L,
            6109L,
            6120L,
            6117L,
            6110L
           )

```

```{r day-1-p1, echo = TRUE}
depth2 <- depth %>% 
  mutate(prev_val = lag(depth),
         change = ifelse(prev_val < depth, "Increased", "Decreased"))

sum_table <- depth2 %>% count(change)

sum_table %>% flextable()
```

The answer to the first puzzle is **`r sum_table$n[2]`**.
`r emo::ji("star")`

## Puzzle 2

Consider sums of a three-measurement sliding window. How many sums are
larger than the previous sum?

```{r day-2-p2, echo = TRUE}
depth3 <- depth2 %>% 
  mutate(sum_val_3 = depth + lead(depth, n = 1) + lead(depth, n = 2),
         prev_sum = lag(sum_val_3),
         change_sum = ifelse(prev_sum < sum_val_3, "Increased", "Decreased"))

sum_table2 <- depth3 %>% count(change_sum)

sum_table2 %>% flextable()
```

The answer to the second puzzle is **`r sum_table2$n[2]`**.
`r emo::ji("star")`

## David Robinson's ([@drob](<https://twitter.com/drob>)) answers

```{r drob-d1-ans, echo = T}
x <- as.vector(depth$depth)  # he probably just imported as a vector

sum(x > lag(x), na.rm = TRUE)

sum(x > lag(x, n = 3), na.rm = TRUE)
```

# Day 2: Dive!

Calculate the horizontal position and depth you would have after
following the planned course. What do you get if you multiply your final
horizontal position by your final depth?

```{r day-2-data, include = FALSE}

# Doesn't work right now.
# d2 <- aoc_get_response(2) %>% 
#   content(encoding = 'UTF-8') %>% 
#   read_lines()

d2 <- c("forward 2",
        "forward 3",
        "forward 5",
        "forward 6",
        "down 7",
        "forward 8",
        "forward 4",
        "forward 7",
        "forward 5",
        "forward 5",
        "down 4",
        "down 9",
        "forward 8",
        "forward 5",
        "up 5",
        "down 5",
        "forward 3",
        "down 4",
        "down 8",
        "forward 9",
        "down 1",
        "up 9",
        "down 7",
        "up 7",
        "up 1",
        "forward 1",
        "down 1",
        "down 4",
        "down 4",
        "down 8",
        "down 4",
        "up 3",
        "down 1",
        "down 3",
        "forward 7",
        "down 6",
        "forward 3",
        "forward 5",
        "forward 2",
        "up 9",
        "forward 7",
        "up 5",
        "down 3",
        "forward 1",
        "forward 2",
        "down 3",
        "down 8",
        "down 3",
        "forward 8",
        "up 5",
        "down 5",
        "forward 3",
        "down 5",
        "forward 9",
        "down 3",
        "down 4",
        "down 9",
        "down 7",
        "up 3",
        "down 9",
        "up 9",
        "up 1",
        "forward 3",
        "up 4",
        "down 3",
        "forward 7",
        "forward 7",
        "up 7",
        "forward 6",
        "down 7",
        "down 6",
        "forward 2",
        "forward 9",
        "down 5",
        "forward 4",
        "up 6",
        "down 1",
        "down 9",
        "down 9",
        "forward 4",
        "down 1",
        "forward 6",
        "down 1",
        "down 5",
        "down 4",
        "down 4",
        "forward 4",
        "forward 9",
        "up 1",
        "down 2",
        "down 8",
        "down 5",
        "down 8",
        "down 8",
        "up 2",
        "forward 8",
        "up 1",
        "forward 4",
        "down 5",
        "down 1",
        "up 2",
        "forward 6",
        "forward 9",
        "forward 2",
        "forward 6",
        "forward 9",
        "up 6",
        "forward 9",
        "up 4",
        "down 7",
        "up 6",
        "forward 2",
        "down 1",
        "up 3",
        "forward 1",
        "forward 8",
        "down 6",
        "down 8",
        "down 8",
        "forward 8",
        "forward 2",
        "forward 2",
        "down 2",
        "up 1",
        "down 9",
        "up 9",
        "down 9",
        "up 3",
        "forward 9",
        "up 4",
        "up 7",
        "up 6",
        "down 9",
        "forward 1",
        "down 3",
        "down 4",
        "forward 8",
        "down 3",
        "down 9",
        "up 3",
        "forward 2",
        "up 5",
        "down 3",
        "forward 8",
        "up 3",
        "down 3",
        "forward 2",
        "forward 9",
        "down 1",
        "down 9",
        "down 4",
        "up 7",
        "down 4",
        "up 6",
        "forward 5",
        "down 6",
        "forward 3",
        "down 2",
        "forward 1",
        "forward 8",
        "down 4",
        "forward 1",
        "up 7",
        "forward 6",
        "up 9",
        "forward 6",
        "down 3",
        "forward 2",
        "down 4",
        "forward 6",
        "down 3",
        "down 6",
        "down 1",
        "down 1",
        "down 5",
        "forward 3",
        "forward 9",
        "forward 8",
        "down 3",
        "forward 7",
        "up 9",
        "forward 9",
        "up 2",
        "forward 4",
        "up 3",
        "forward 1",
        "up 6",
        "up 8",
        "down 5",
        "down 6",
        "up 9",
        "down 6",
        "down 9",
        "up 9",
        "down 4",
        "forward 5",
        "up 2",
        "down 3",
        "up 3",
        "down 1",
        "forward 3",
        "down 5",
        "forward 7",
        "down 6",
        "down 7",
        "down 5",
        "forward 2",
        "up 6",
        "down 9",
        "down 4",
        "down 3",
        "forward 9",
        "up 8",
        "forward 2",
        "down 2",
        "forward 4",
        "up 6",
        "down 4",
        "up 8",
        "down 7",
        "down 2",
        "up 6",
        "up 4",
        "down 2",
        "forward 5",
        "up 4",
        "down 8",
        "forward 3",
        "forward 1",
        "down 7",
        "forward 8",
        "forward 7",
        "down 7",
        "up 4",
        "forward 8",
        "down 5",
        "up 9",
        "forward 1",
        "forward 4",
        "forward 9",
        "forward 7",
        "down 9",
        "up 9",
        "down 1",
        "down 7",
        "forward 7",
        "down 7",
        "down 7",
        "down 3",
        "down 5",
        "forward 3",
        "down 2",
        "forward 6",
        "down 9",
        "up 5",
        "up 3",
        "forward 5",
        "down 6",
        "down 1",
        "forward 4",
        "down 3",
        "forward 8",
        "down 7",
        "forward 7",
        "forward 7",
        "up 7",
        "up 2",
        "up 3",
        "forward 9",
        "down 5",
        "up 2",
        "forward 5",
        "up 5",
        "forward 2",
        "forward 2",
        "down 8",
        "forward 2",
        "up 4",
        "forward 1",
        "forward 3",
        "up 8",
        "up 9",
        "forward 5",
        "down 1",
        "up 8",
        "down 4",
        "down 8",
        "up 4",
        "forward 9",
        "down 6",
        "down 8",
        "up 2",
        "up 3",
        "down 7",
        "down 4",
        "forward 5",
        "down 6",
        "forward 3",
        "forward 3",
        "forward 8",
        "down 1",
        "down 7",
        "down 9",
        "down 2",
        "down 7",
        "forward 7",
        "down 7",
        "down 6",
        "up 6",
        "forward 8",
        "forward 5",
        "up 5",
        "down 2",
        "up 8",
        "up 4",
        "down 9",
        "up 2",
        "forward 5",
        "up 2",
        "down 4",
        "up 4",
        "forward 2",
        "forward 4",
        "forward 9",
        "forward 9",
        "up 4",
        "up 5",
        "down 1",
        "down 6",
        "down 1",
        "down 4",
        "down 5",
        "down 3",
        "forward 3",
        "down 9",
        "forward 6",
        "down 3",
        "down 9",
        "down 2",
        "up 2",
        "down 2",
        "down 7",
        "forward 9",
        "down 3",
        "down 3",
        "down 2",
        "down 3",
        "forward 2",
        "down 9",
        "down 9",
        "up 5",
        "up 3",
        "forward 4",
        "up 7",
        "forward 8",
        "up 6",
        "forward 7",
        "down 7",
        "down 1",
        "forward 5",
        "down 2",
        "up 1",
        "down 8",
        "up 3",
        "forward 2",
        "up 9",
        "down 1",
        "down 3",
        "down 6",
        "down 2",
        "down 7",
        "up 2",
        "forward 5",
        "forward 7",
        "down 2",
        "forward 5",
        "forward 4",
        "forward 5",
        "down 3",
        "forward 7",
        "down 7",
        "forward 8",
        "down 3",
        "down 2",
        "up 1",
        "forward 6",
        "down 4",
        "down 2",
        "forward 7",
        "up 3",
        "down 4",
        "forward 2",
        "up 6",
        "down 3",
        "up 6",
        "up 8",
        "down 9",
        "up 6",
        "forward 8",
        "forward 9",
        "forward 4",
        "forward 7",
        "down 2",
        "forward 9",
        "down 7",
        "up 9",
        "down 5",
        "down 6",
        "up 5",
        "down 4",
        "forward 8",
        "forward 4",
        "forward 4",
        "down 6",
        "forward 3",
        "forward 6",
        "down 9",
        "down 9",
        "up 2",
        "forward 7",
        "down 8",
        "down 9",
        "down 9",
        "forward 7",
        "forward 3",
        "down 7",
        "down 8",
        "forward 8",
        "down 6",
        "down 5",
        "down 9",
        "down 3",
        "forward 1",
        "down 5",
        "forward 2",
        "forward 8",
        "down 2",
        "forward 6",
        "forward 3",
        "down 7",
        "down 4",
        "forward 8",
        "forward 1",
        "down 6",
        "forward 9",
        "forward 6",
        "up 1",
        "up 3",
        "down 8",
        "forward 1",
        "up 5",
        "down 4",
        "forward 7",
        "up 3",
        "down 2",
        "forward 1",
        "forward 9",
        "down 9",
        "down 7",
        "forward 8",
        "down 4",
        "up 3",
        "down 4",
        "forward 2",
        "forward 6",
        "down 7",
        "forward 6",
        "down 6",
        "down 4",
        "down 1",
        "up 9",
        "down 4",
        "down 7",
        "up 4",
        "down 9",
        "forward 6",
        "down 3",
        "forward 2",
        "down 4",
        "forward 3",
        "down 5",
        "up 9",
        "forward 8",
        "up 7",
        "up 6",
        "up 4",
        "forward 1",
        "down 1",
        "forward 4",
        "up 6",
        "forward 5",
        "forward 4",
        "forward 5",
        "up 6",
        "down 1",
        "forward 3",
        "up 7",
        "down 9",
        "up 9",
        "down 5",
        "forward 6",
        "forward 4",
        "up 1",
        "down 4",
        "up 1",
        "forward 3",
        "forward 1",
        "down 3",
        "forward 7",
        "down 2",
        "forward 3",
        "up 2",
        "forward 8",
        "down 3",
        "up 9",
        "down 5",
        "forward 6",
        "down 1",
        "down 8",
        "down 5",
        "forward 1",
        "down 6",
        "up 2",
        "forward 6",
        "down 2",
        "down 1",
        "up 6",
        "up 7",
        "down 5",
        "forward 7",
        "forward 6",
        "forward 6",
        "down 7",
        "forward 4",
        "down 5",
        "up 5",
        "down 1",
        "up 8",
        "down 8",
        "down 2",
        "down 2",
        "down 9",
        "up 9",
        "forward 2",
        "forward 7",
        "down 7",
        "down 4",
        "down 4",
        "down 8",
        "forward 5",
        "forward 2",
        "up 9",
        "down 9",
        "forward 7",
        "up 9",
        "down 2",
        "down 7",
        "up 2",
        "up 8",
        "forward 8",
        "down 4",
        "forward 3",
        "forward 4",
        "forward 6",
        "forward 2",
        "down 1",
        "down 2",
        "forward 2",
        "up 1",
        "down 1",
        "forward 5",
        "up 3",
        "up 3",
        "down 3",
        "down 1",
        "down 4",
        "up 5",
        "up 6",
        "forward 5",
        "up 7",
        "forward 6",
        "down 4",
        "down 7",
        "up 8",
        "forward 1",
        "down 5",
        "up 4",
        "up 3",
        "up 5",
        "down 1",
        "up 5",
        "forward 3",
        "up 5",
        "forward 2",
        "forward 2",
        "forward 5",
        "forward 2",
        "up 9",
        "forward 4",
        "down 1",
        "down 3",
        "down 5",
        "up 2",
        "down 8",
        "forward 8",
        "forward 9",
        "down 1",
        "down 3",
        "forward 8",
        "forward 2",
        "down 2",
        "down 1",
        "up 7",
        "forward 2",
        "forward 8",
        "down 9",
        "forward 1",
        "forward 4",
        "down 7",
        "down 4",
        "up 7",
        "down 3",
        "down 1",
        "down 4",
        "up 7",
        "down 6",
        "forward 7",
        "down 8",
        "up 2",
        "up 4",
        "up 6",
        "down 9",
        "down 9",
        "down 8",
        "forward 6",
        "up 3",
        "up 1",
        "forward 9",
        "forward 6",
        "up 4",
        "up 2",
        "up 7",
        "forward 5",
        "up 9",
        "up 9",
        "forward 9",
        "up 6",
        "down 1",
        "down 3",
        "forward 3",
        "down 2",
        "down 2",
        "down 6",
        "down 9",
        "forward 3",
        "forward 7",
        "up 3",
        "forward 3",
        "down 5",
        "forward 9",
        "up 6",
        "down 2",
        "forward 8",
        "down 3",
        "up 5",
        "down 6",
        "forward 9",
        "down 5",
        "down 2",
        "down 6",
        "forward 8",
        "forward 6",
        "down 1",
        "forward 6",
        "up 1",
        "up 7",
        "down 4",
        "down 7",
        "forward 4",
        "forward 7",
        "down 4",
        "forward 8",
        "down 8",
        "down 7",
        "forward 9",
        "down 1",
        "down 3",
        "down 6",
        "forward 7",
        "forward 6",
        "forward 3",
        "forward 8",
        "down 5",
        "down 3",
        "up 1",
        "down 9",
        "down 8",
        "forward 3",
        "down 6",
        "down 1",
        "forward 5",
        "forward 5",
        "forward 9",
        "up 5",
        "down 6",
        "up 9",
        "down 7",
        "down 6",
        "up 1",
        "forward 5",
        "forward 7",
        "forward 8",
        "forward 7",
        "forward 6",
        "forward 3",
        "forward 1",
        "forward 2",
        "up 4",
        "forward 3",
        "forward 4",
        "forward 5",
        "up 2",
        "up 3",
        "forward 4",
        "down 9",
        "up 4",
        "forward 7",
        "down 6",
        "down 6",
        "down 1",
        "forward 2",
        "down 2",
        "forward 2",
        "down 3",
        "forward 7",
        "forward 8",
        "down 4",
        "up 7",
        "forward 7",
        "down 7",
        "forward 7",
        "forward 9",
        "down 7",
        "up 2",
        "down 3",
        "forward 7",
        "down 1",
        "forward 8",
        "forward 2",
        "up 9",
        "down 3",
        "forward 2",
        "up 4",
        "forward 9",
        "down 4",
        "down 4",
        "forward 4",
        "down 2",
        "down 9",
        "forward 4",
        "down 2",
        "down 6",
        "forward 9",
        "forward 2",
        "up 1",
        "forward 2",
        "forward 3",
        "down 5",
        "up 8",
        "down 4",
        "down 4",
        "forward 7",
        "down 2",
        "up 6",
        "down 9",
        "forward 9",
        "up 1",
        "forward 3",
        "down 5",
        "forward 3",
        "down 3",
        "forward 4",
        "up 3",
        "down 6",
        "down 7",
        "down 4",
        "down 8",
        "down 4",
        "down 5",
        "up 9",
        "up 1",
        "down 7",
        "up 3",
        "up 3",
        "down 3",
        "up 4",
        "up 6",
        "forward 8",
        "down 1",
        "forward 7",
        "forward 4",
        "down 9",
        "down 1",
        "forward 7",
        "forward 9",
        "forward 1",
        "down 3",
        "down 2",
        "forward 3",
        "forward 2",
        "down 7",
        "forward 9",
        "forward 6",
        "up 9",
        "down 2",
        "forward 9",
        "up 6",
        "forward 8",
        "up 1",
        "down 5",
        "down 8",
        "forward 1",
        "down 1",
        "forward 9",
        "up 1",
        "forward 9",
        "forward 1",
        "forward 1",
        "down 7",
        "forward 3",
        "forward 6",
        "down 5",
        "forward 7",
        "forward 1",
        "down 7",
        "down 6",
        "down 6",
        "forward 5",
        "up 6",
        "down 6",
        "forward 8",
        "up 2",
        "down 8",
        "down 3",
        "up 5",
        "up 8",
        "down 6",
        "forward 4",
        "forward 2",
        "up 3",
        "forward 5",
        "forward 3",
        "up 8",
        "forward 6",
        "up 8",
        "forward 1",
        "up 8",
        "up 7",
        "up 6",
        "forward 2",
        "down 9",
        "down 9",
        "forward 3",
        "down 7",
        "forward 3",
        "down 6",
        "forward 9",
        "up 5",
        "down 1",
        "forward 7",
        "down 1",
        "down 5",
        "down 9",
        "forward 8",
        "forward 9",
        "forward 7",
        "down 9",
        "up 4",
        "forward 5",
        "down 5",
        "forward 5",
        "down 9",
        "forward 9",
        "forward 3",
        "up 5",
        "forward 8",
        "up 5",
        "down 1",
        "forward 8",
        "down 3",
        "forward 6",
        "up 9",
        "forward 8",
        "down 4",
        "forward 3",
        "down 5",
        "forward 8",
        "forward 9",
        "forward 2",
        "down 1",
        "down 6",
        "down 4",
        "forward 9",
        "up 2",
        "down 3",
        "down 6",
        "down 3",
        "down 9",
        "down 1",
        "up 6",
        "down 2",
        "down 7",
        "up 5",
        "forward 5",
        "up 1",
        "down 7",
        "forward 6",
        "up 6",
        "down 2",
        "down 3",
        "forward 3",
        "down 5",
        "forward 8",
        "down 9",
        "down 7",
        "down 8",
        "up 7",
        "down 1",
        "forward 1",
        "forward 1",
        "down 2",
        "up 4",
        "forward 2",
        "down 3",
        "up 2",
        "down 3",
        "down 2",
        "forward 7",
        "down 1",
        "up 7",
        "down 2",
        "down 1",
        "forward 6",
        "down 9",
        "up 9",
        "down 4",
        "down 6",
        "up 9",
        "forward 7",
        "forward 9",
        "forward 7",
        "down 4",
        "down 1",
        "forward 7",
        "down 4",
        "down 7",
        "down 3",
        "down 5",
        "forward 3",
        "down 8",
        "forward 8",
        "forward 7",
        "forward 8",
        "down 4",
        "down 9",
        "forward 2",
        "forward 7",
        "up 8",
        "forward 4",
        "down 6",
        "up 8",
        "down 2",
        "forward 3",
        "down 6",
        "down 8",
        "forward 8",
        "forward 2",
        "forward 9",
        "up 6",
        "forward 7",
        "down 3",
        "down 5",
        "forward 8",
        "forward 9",
        "down 3",
        "forward 3",
        "forward 2",
        "forward 3",
        "down 8",
        "up 9",
        "up 5",
        "up 2",
        "up 6",
        "up 1",
        "up 1",
        "up 5",
        "forward 3",
        "forward 2",
        "down 3",
        "forward 4")



```

## Puzzle 1

It seems like the submarine can take a series of commands like forward 1,
down 2, or up 3:

+ forward X increases the horizontal position by X units.
+ down X increases the depth by X units.
+ up X decreases the depth by X units.


```{r day-2-work, echo = TRUE}
d2_dt <- d2 %>% as_tibble() %>% 
  separate(value, into = c("direction", "distance"), sep = " ") %>% 
  mutate(distance = as.numeric(distance))



location <- d2_dt %>% 
  group_by(direction) %>% 
  summarize(across(distance, sum))

location %>% flextable()

```

Answer #1:
**`r (location$distance[1] - location$distance[3]) * location$distance[2]`**
`r emo::ji("star")`

## Puzzle 2

In addition to horizontal position and depth, you'll also need to track
a third value, aim, which also starts at 0. The commands also mean
something entirely different than you first thought:

-   down X increases your aim by X units.

-   up X decreases your aim by X units.

-   forward X does two things:

    -   It increases your horizontal position by X units.
    -   It increases your depth by your aim multiplied by X.

```{r d-2-p-2, echo = TRUE}

sum_aim <- d2_dt %>% 
  mutate(x = case_when(direction == "forward" ~ 1,
                       TRUE ~ 0),
         y = case_when(direction == "up" ~ -1,
                       direction == "down" ~ 1,
                       TRUE ~ 0)) %>% 
  mutate(aim = cumsum(distance * y)) %>% 
  summarize(horizontal = sum(distance * x),
            depth = sum(distance * aim * x),
            product = depth * horizontal)

```

Answer #2:
**`r sum_aim$product`** `r emo::ji("star")`

## DR answer

```{r dr-2, echo = TRUE}
directions <- tribble(
  ~ direction, ~ x, ~ y,
  "down", 0, 1,
  "up", 0, -1,
  "forward", 1, 0
)

joined <- d2_dt %>% 
  inner_join(directions, by = "direction")


# Puzzle 1
joined %>% 
  summarize(horizontal = sum(distance * x),
            depth = sum(distance * y),
            product = horizontal * depth)

# Puzzle 2
joined %>% 
  mutate(aim = cumsum(y * distance)) %>% 
  summarize(horizontal = sum(distance * x),
            depth = sum(aim * distance * x),
            product = horizontal * depth)
```

# Day 3: Binary Diagnostic

The submarine has been making some odd creaking noises, so you ask it to produce
a diagnostic report just in case.

The diagnostic report (your puzzle input) consists of a list of binary numbers
which, when decoded properly, can tell you many useful things about the
conditions of the submarine. The first parameter to check is the power
consumption.

## Puzzle 1

You need to use the binary numbers in the diagnostic report to generate two new
binary numbers (called the gamma rate and the epsilon rate). The power
consumption can then be found by multiplying the gamma rate by the epsilon rate.

Use the binary numbers in your diagnostic report to calculate the gamma rate and epsilon rate, then multiply them together. What is the power consumption of the submarine? (Be sure to represent your answer in decimal, not binary.)

```{r d-3-data, include = FALSE}

options(scipen = 999)

d3_df <- read.table(here("data", "aoc", "d3.txt"), header = FALSE) %>% 
  mutate(V1 = str_pad(V1, 12, pad = "0")) 

d3_mat <- str_split(d3_df$V1, "") %>% 
  map(as.integer) %>% 
  do.call(rbind, .)

most_common <- round(colMeans(d3_mat, na.rm = T))

least_common <- round(1 - colMeans(d3_mat, na.rm = TRUE))

gamma <- strtoi(paste0(most_common, collapse = ""), base = 2)

epsilon <- paste0(least_common, collapse = "") %>% strtoi(base = 2)

gamma * epsilon
```


```{r d3-test, eval = FALSE}
test <- c("00100", "11110", "10110", "10111", "10101", "01111", "00111", "11100", "10000", "11001", "00010", "01010") %>% 
  as.matrix()


mat <- str_split(test, "") %>% 
  map(as.integer) %>% 
  do.call(rbind, .)

a <- round(colMeans(mat))
b <- round(1 - colMeans(mat))


mat %>% 
  as.data.frame() %>% 
  filter(V1 == a[1],
         V2 == a[2],
         V3 == a[3],
         V4 == a[4],
         V5 == 1)

  
```

Answer #1:
**`r gamma * epsilon`** `r emo::ji("star")`

## Puzzle 2

```{r d3-p2, echo = TRUE}
ox_bi <- d3_mat %>% 
  as.data.frame() %>% 
  filter(V1 == most_common[1]) %>% 
  filter(V2 == round(mean(.$V2) + 1e-6)) %>% 
  filter(V3 == round(mean(.$V3) + 1e-6)) %>% 
  filter(V4 == round(mean(.$V4) + 1e-6)) %>% 
  filter(V5 == round(mean(.$V5) + 1e-6)) %>% 
  filter(V6 == round(mean(.$V6) + 1e-6)) %>% 
  filter(V7 == round(mean(.$V7) + 1e-6)) %>% 
  filter(V8 == round(mean(.$V8) + 1e-6)) %>% 
  filter(V9 == round(mean(.$V9) + 1e-6)) %>% 
  filter(V10 == round(mean(.$V10) + 1e-6)) %>% 
  filter(V11 == round(mean(.$V11) + 1e-6)) %>% 
  filter(V12 == 1)

co2_bi <- d3_mat %>% 
  as.data.frame() %>% 
  filter(V1 == least_common[1]) %>% 
  filter(V2 != round(mean(.$V2) + 1e-6)) %>% 
  filter(V3 != round(mean(.$V3) + 1e-6)) %>% 
  filter(V4 != round(mean(.$V4) + 1e-6)) %>% 
  filter(V5 != round(mean(.$V5) + 1e-6)) %>% 
  filter(V6 != round(mean(.$V6) + 1e-6)) %>% 
  filter(V7 != round(mean(.$V7) + 1e-6)) %>% 
  filter(V8 != round(mean(.$V8) + 1e-6)) %>% 
  filter(V9 != 1)

oxygen <- strtoi(paste0(ox_bi, collapse = ""), base = 2)

co2 <- paste0(co2_bi, collapse = "") %>% strtoi(base = 2)

oxygen * co2
```

Answer #2:
**`r oxygen * co2`** `r emo::ji("star")`

## DR answer

```{r d3-dr, echo = TRUE}
to_decimal <- function(x) {
  strtoi(paste0(x, collapse = ""), base = 2)
}

mat <- str_split(d3_df$V1, "") %>% 
  map(as.integer) %>% 
  do.call(rbind, .)

most_common <- round(colMeans(mat))

to_decimal(most_common) * to_decimal(1 - most_common)

filter_matrix <- function(m, index, most_common = TRUE) {
  target <- round(mean(m[, index]) + 1e-6)  # to round up
  
  if (!most_common) {
    target <- 1 - target
  }
  
  ret <- m[m[, index] == target, ]
  
  # Extracting one row from a matrix makes it a vector
  if (!is.matrix(ret)) {
    done(ret)
  } else {
    ret
  }
}

oxygen <- reduce(1:12, filter_matrix, .init = mat)

co2 <- reduce(1:12, filter_matrix, .init = mat, most_common = FALSE)

to_decimal(oxygen) * to_decimal(co2)
```


# Day 4: Giant Squid

I couldn't figure this one out on my own so I used \@drob's answer

```{r d4-data, include = FALSE}
d4 <- import(here("data", "aoc", "d4.xlsx"), which = "cards") %>% 
  janitor::remove_empty(which = "rows") %>% 
  mutate(card_id = rep(1:100, each = 5))

d4_nos <- import(here("data", "aoc", "d4.xlsx"), which = "draws") %>% 
  colnames()

d4_df <- str_split(d4$cards, " ") %>% 
  map(as.integer) %>% 
  map(stats::na.omit) %>% 
  do.call(rbind, .) %>% 
  cbind(d4$card_id) %>% 
  as.data.frame() %>% 
  rename(card_id = V6)

col_check <- function(df) {
  df %>% 
  group_by(card_id) %>% 
  summarize(across(V1:V5, sum)) %>% 
  filter(V1 == 0 | V2 == 0 | V3 == 0 | V4 == 0 | V5 == 0)
}

row_check <- function(df) {
  df %>% 
  rowwise() %>% 
  mutate(sum_row = sum(V1, V2, V3, V4, V5)) %>% 
  filter(sum_row == 0)
}

bingo <- function(df, nos) {
  df[df %in% nos] <- 0
  
  col <- df %>% 
    col_check()
  
  row <- df %>% 
    row_check()
  
  return(list(col, row))
}
```


```{r d4-work, echo = TRUE}

# browseURL("https://twitter.com/drob/status/1467157923512127488/photo/1")

d4_nos <- as.integer(d4_nos)

boards <- d4 %>% 
  group_by(card_id) %>% 
  mutate(row = row_number()) %>% 
  separate_rows(cards, sep = " +", convert = TRUE) %>% 
  group_by(card_id, row) %>% 
  mutate(col = row_number()) %>% 
  ungroup() %>% 
  mutate(turn = match(cards, d4_nos))
  

board_turn_win <- boards %>% 
  gather(coordinate, cards, row, col) %>% 
  group_by(card_id, coordinate, cards) %>% 
  summarize(complete_on_turn = max(turn)) %>% 
  group_by(card_id) %>% 
  summarize(win_on_turn = min(complete_on_turn))

board_scores <- board_turn_win %>% 
  inner_join(boards, by = "card_id") %>% 
  group_by(card_id, win_on_turn) %>% 
  summarize(total_undrawn = sum(cards[turn > win_on_turn]), 
            .groups = "drop") %>% 
  mutate(answer = d4_nos[win_on_turn] * total_undrawn)

board_scores %>% 
  slice_min(win_on_turn)
```

Answer #1:
**14093** `r emo::ji("star")`

## Puzzle #2

```{r d4-p2, echo = TRUE}
board_scores %>% 
  slice_max(win_on_turn)
```

Answer #2:
**17388** `r emo::ji("star")`

# Day 5: Hydrothermal Venture

```{r d5-test, eval = FALSE}
test <- tibble(
  x1 = c(0, 8, 9, 2, 7, 6, 0, 3, 0, 5),
  y1 = c(9, 0, 4, 2, 0, 4, 9, 4, 0, 5),
  x2 = c(5, 0, 3, 2, 7, 2, 2, 1, 8, 8),
  y2 = c(9, 8, 4, 1, 4, 0, 9, 4, 8, 2)
)


test %>% 
#  filter(x1 == x2 | y1 == y2) %>% 
  mutate(x = map2(x1, x2, seq)) %>% 
  mutate(y = map2(y1, y2, seq)) %>%
  unnest(c(x,y)) %>% 
  count(x, y) %>% 
  summarize(sum(n>1))

```

## Puzzle #1

```{r d5-data-p1, echo = TRUE}
d5 <- import(here("data", "aoc", "d5.xlsx"))

d5 %>% 
  filter(x1 == x2 | y1 == y2) %>% 
  mutate(x = map2(x1, x2, seq)) %>% 
  mutate(y = map2(y1, y2, seq)) %>%
  unnest(c(x,y)) %>% 
  count(x, y) %>% 
  summarize(sum(n > 1))


```

Answer #1:
**4745** `r emo::ji("star")`

## Puzzle #2

```{r d5-p2, echo = TRUE}

d5 %>% 
#  filter(x1 == x2 | y1 == y2) %>% 
  mutate(x = map2(x1, x2, seq)) %>% 
  mutate(y = map2(y1, y2, seq)) %>%
  unnest(c(x,y)) %>% 
  count(x, y) %>% 
  summarize(sum(n > 1))


```

Answer #1:
**18442** `r emo::ji("star")`

# Day 6: Lanternfish 

## Puzzle #1

```{r d6-p1, echo = TRUE}

# browseURL("https://selbydavid.com/2021/12/01/advent-2021/")

d6 <- import(here("data", "aoc", "d6.xlsx"))

fish_0 <- as.vector(d6$timer)

fish_count <- function(x, days = 80) {
  fish <- as.double(table(factor(x, levels = 0:8)))
  
  for (i in 1:days)
    fish <-  c(fish[2:7], fish[8] + fish[1], fish[9], fish[1])
  sum(fish)
}

fish_count(fish_0, days = 80)

```

Answer #1:
**`r fish_count(fish_0)`** `r emo::ji("star")`

## Puzzle #2

```{r d6-p2, echo = TRUE}
options(scipen = 999)

fish_count(fish_0, days = 256)
```

Answer #2:
**`r fish_count(fish_0, days = 256)`** `r emo::ji("star")`

# Day 7: The Treachery of Whales

## Puzzle #1

```{r d7-p1, include = TRUE, echo = TRUE}
d7 <- import(here("data", "aoc", "d7.xlsx"))

mean_loc <- floor(mean(d7$position)) # tried floor() and ceiling()
median_loc <- round(median(d7$position))

crabs <- d7 %>% 
  mutate(fuel_median = case_when(position < median_loc ~ median_loc - position,
                          position >= median_loc ~ position - median_loc),
         fuel_median_2 = abs(median_loc - position))  # shorter

sum(crabs$fuel_median)
```

Answer #1:

**`r sum(crabs$fuel_median)`** `r emo::ji("star")`

## Puzzle #2

```{r d7-p2, include = TRUE, echo = TRUE}

crabs <- crabs %>% 
  mutate(fuel_mean = abs(mean_loc - position),
         fuel_cost = fuel_mean / 2 * (1 + fuel_mean))

sum(crabs$fuel_cost)
```

Answer #2:

**`r sum(crabs$fuel_cost)`** `r emo::ji("star")`

# Day 8: Seven Segment Search

## Puzzle #1

```{r d8-p1, include = TRUE, echo = TRUE}
d8 <- import(here("data", "aoc", "d8.xlsx")) %>% 
  mutate(entry = row_number(), .before = 1)

sum_table <- d8 %>% 
  summarize(across(o1:o4, ~ nchar(.))) %>% 
  pivot_longer(everything()) %>% 
  count(value)

sum(sum_table$n[c(1, 2, 3, 6)])


```

Answer #1:
**`r sum(sum_table$n[c(1, 2, 3, 6)])`** `r emo::ji("star")`

## Puzzle #2

```{r d8-p2, include = TRUE}
d8_b <- d8 %>% 
  mutate(o1_b = case_when(nchar(o1) == 2 ~ 1,
                          nchar(o1) == 3 ~ 7,
                          nchar(o1) == 4 ~ 4,
                          nchar(o1) == 7 ~ 8,
                          TRUE ~ NA_real_),
         o2_b = case_when(nchar(o2) == 2 ~ 1,
                          nchar(o2) == 3 ~ 7,
                          nchar(o2) == 4 ~ 4,
                          nchar(o2) == 7 ~ 8,
                          TRUE ~ NA_real_),
         o3_b = case_when(nchar(o3) == 2 ~ 1,
                          nchar(o3) == 3 ~ 7,
                          nchar(o3) == 4 ~ 4,
                          nchar(o3) == 7 ~ 8,
                          TRUE ~ NA_real_),
         o4_b = case_when(nchar(o4) == 2 ~ 1,
                          nchar(o4) == 3 ~ 7,
                          nchar(o4) == 4 ~ 4,
                          nchar(o4) == 7 ~ 8,
                          TRUE ~ NA_real_))




# browseURL("https://pbs.twimg.com/media/FGGf6qNWQAMNOOc?format=jpg&name=large")
```

# Day 9: Smoke Basin

## Puzzle #1

```{r d9, echo = TRUE}
input <- advent_input(9)


x <- input %>% 
  mutate(row = row_number()) %>% 
  mutate(value = str_split(x, "")) %>% 
  unnest(value) %>% 
  mutate(value = as.numeric(value)) %>% 
  group_by(row) %>% 
  mutate(col = row_number()) %>% 
  ungroup()

adj <- tibble(xd = c(-1, 1, 0, 0),
              yd = c(0, 0, -1, 1))

adjacent <- function(d, d2) {
  d %>% 
    crossing(adj) %>% 
    mutate(row2 = row + xd,
           col2 = col + yd) %>% 
    inner_join(d2, by = c(row2 = "row", col2 = "col"), suffix = c("", "2")) %>% 
    filter(row != row2 | col != col2)
}

```


```{r d9-rayshade, include = FALSE, eval = FALSE}
d9_mat <- d9 %>% 
  map(as.integer) %>% 
  do.call(rbind, .)


# d9_mat %>%
#   rayshader::ray_shade(d9_mat) %>%
#   rayshader::plot_3d(d9_mat)

input %>% grid_graph(x)

input %>%
  grid_graph(x) %>%
  filter(value != 9) %>%
  mutate(component = tidygraph::group_components()) %>%
  as_tibble() %>%
  count(component, sort = TRUE) %>%
  head(3) %>%
  summarize(answer = prod(n))
```

```{r d9-p1, echo = TRUE}
low_points <- x %>% 
  adjacent(x) %>% 
  group_by(row, col) %>% 
  summarize(low = all(value < value2)) %>% 
  filter(low) %>% 
  inner_join(x, by = c("row", "col")) %>% 
  ungroup()

low_points %>% 
  summarize(sum(1 + value))


```

Answer #1:
**`r low_points %>% summarize(sum(1 + value))`** `r emo::ji("star")`

## Puzzle #2

```{r d9-p2, echo = TRUE}
frontier <- low_points %>% 
  mutate(basin = paste(row, col)) %>% 
  select(basin, row, col, value)

basins <- frontier

while (nrow(frontier) > 0) {
  frontier <- frontier %>% 
    adjacent(x) %>% 
    filter(value2 > value, value2 < 9) %>% 
    select(basin, row = row2, col = col2, value = value2) %>% 
    distinct(basin, row, col, .keep_all = TRUE) %>% 
    anti_join(basins, by = c("row", "col"))
  
  basins <- bind_rows(basins, frontier)
}

basins %>% 
  count(basin, sort = TRUE) %>% 
  head(3) %>% 
  summarize(prod(n))

```

Answer #2:
**1048128** `r emo::ji("star")`

# Day 10: Syntax Scoring

## Puzzle #1

```{r d10-data, echo = TRUE}
# browseURL("https://pbs.twimg.com/media/FGRdRyWXIAUx3vw?format=jpg&name=large")

input <- advent_input(10)

d10 <- read_lines(here("data", "aoc", "d10.txt"))

corruption_values <- c(")" = 3, "]" = 57, "}" = 1197, ">" = 25137)

opening <- c("(", "[", "{", "<")
closing <- c(")", "]", "}", ">")

opening_matches <- opening
names(opening_matches) <- closing

is_match <- function(x, current) {
  if (length(x) == 0) return(FALSE)
  current %in% closing && tail(x, 1) == opening_matches[current]
}

is_corrupt <- function(x, current) {
  if (length(x) == 0) return(FALSE)
  current %in% closing && opening_matches[current] != tail(x, 1)
}

test <- input %>% slice(54)

nchar(test)

corruption_value <- function(line) {
  chars <- line %>% str_split("") %>% .[[1]]
  
  x <- c()
  next_char_idx <- 1
  
  while (next_char_idx <= length(chars) && !is_corrupt(x, chars[next_char_idx])) {
    if (is_match(x, chars[next_char_idx])) {
      x <- head(x, length(x) - 1)
    } else {
      x <- c(x, chars[next_char_idx])
    }
    
    next_char_idx <- next_char_idx + 1
  }
  
  if (!next_char_idx > length(chars)) {
    value <- corruption_values[chars[next_char_idx]]
  } else {
    value <- 0
  }
  
  return(value)
}



```

Answer #1:
**`r map_dbl(d10, corruption_value) %>% sum()`** `r emo::ji("star")`

## Puzzle #2

```{r d10-p2, echo = TRUE}
completion_values <- c("(" = 1, "[" = 2, "{" = 3, "<" = 4)

incomplete_lines <- keep(d10, .p = ~{corruption_value(.x) == 0})

completion_value <- function(line) {
  chars <- line %>% str_split("") %>% .[[1]]
  
  x <- c()
  next_char_idx <- 1
  
  while (next_char_idx <= length(chars)) {
    if (is_match(x, chars[next_char_idx])) {
      x <- head(x, length(x) - 1)
    } else {
      x <- c(x, chars[next_char_idx])
    }
    
    next_char_idx <- next_char_idx + 1
  }
  
  reduce(rev(x), function(prev, current) {
    return(prev * 5 + completion_values[current])
  }, .init = 0)
}


```

Answer #2:
**`r map_dbl(incomplete_lines, completion_value) %>% median()`** `r emo::ji("star")`

# Day 11: Dumbo Octopus

## Puzzle #1

```{r d11-p1, echo = TRUE}
input <- advent_input(11)

x <- input %>% grid_tidy(x)

part1 <- 0

adjacent_join <- function(x, y = x, diagonal = FALSE, suffix = c("", "2")) {
  adj <- tibble(row_delta = c(-1, 1, 0, 0),
                col_delta = c(0, 0, -1, 1))

  if (diagonal) {
    adj <- bind_rows(adj,
                     tibble(row_delta = c(-1, -1, 1, 1),
                            col_delta = c(-1, 1, -1, 1)))
  }

  x %>%
    tidyr::crossing(adj) %>%
    mutate(row2 = row + row_delta,
           col2 = col + col_delta) %>%
    inner_join(y, by = c(row2 = "row", col2 = "col"), suffix = suffix) %>%
    filter(row != row2 | col != col2) %>%
    select(-row_delta, -col_delta)
}

# x <- tibble::tribble(
#                  ~x,
#           5483143223,
#           2745854711,
#           5264556173,
#           6141336146,
#           6357385478,
#           4167524645,
#           2176841721,
#           6882881134,
#           4846848554,
#           5283751526
#           ) %>% grid_tidy(x)



for (i in 1:100) {  # change 10 i in 1:1000 get answer for Puzzle #2
  x <- x %>% 
    mutate(value = value + 1,
           flash = value > 9,
           has_flashed = flash)
  
  while (any(x$flash)) {
    part1 <- part1 + sum(x$flash)
    x <- x %>% 
      adjacent_join(diagonal = TRUE) %>% 
      group_by(row, col, value, flash, has_flashed) %>% 
      summarize(value = first(value) + sum(flash2),
                .groups = "drop") %>% 
      mutate(flash = value > 9 & !has_flashed) %>% 
      mutate(has_flashed = flash | has_flashed)
    
    #Part 2
    if (all(x$has_flashed | x$flash)) {
      stop(paste0("All have flashed as of step ", i))
    }
  }
  x <- x %>% 
    mutate(value = ifelse(has_flashed, 0, value))
}

```

Answer #1:
**`r part1`** `r emo::ji("star")`

## Puzzle #2

```{r d11-p2, eval = FALSE}
x <- input %>% grid_tidy(x)

for (i in 1:1000) {
  x <- x %>% 
    mutate(value = value + 1,
           flash = value > 9,
           has_flashed = flash)
  
  while (any(x$flash)) {
    part1 <- part1 + sum(x$flash)
    x <- x %>% 
      adjacent_join(diagonal = TRUE) %>% 
      group_by(row, col, value, flash, has_flashed) %>% 
      summarize(value = first(value) + sum(flash2),
                .groups = "drop") %>% 
      mutate(flash = value > 9 & !has_flashed) %>% 
      mutate(has_flashed = flash | has_flashed)
    
    #Part 2
    if (all(x$has_flashed | x$flash)) {
      stop(paste0("All have flashed as of step ", i))
    }
  }
  x <- x %>% 
    mutate(value = ifelse(has_flashed, 0, value))
}


```

Answer #2:
**220** `r emo::ji("star")`

# Day 12: Passage Pathing

```{r d12-p1, echo = TRUE}
p_load(tidygraph, ggraph)

input <- advent_input(12)

once <- c("start", "end", "ko", "kw", "lj", "qm", "vn", "xy", "kh")
multi <- c("DD", "KG", "MV", "VH")

x <- input %>% 
  separate(x, into = c("from", "to"), sep = "-") %>% 
  mutate(dist = 1)


graph_routes <- as_tbl_graph(x)

graph_routes %>% 
  ggraph(layout = "kk") + 
  geom_edge_link() +
  geom_node_label(aes(label = name, 
                      fill = ifelse(name %in% once, "blue", "orange")), 
                  size = 4, show.legend = FALSE) + 
  scale_fill_manual(values = c("#DEC000FF", "#677E8EFF"))

```

## Puzzle #1

```{r d12-p1-2, echo = TRUE}
connections <- x %>% 
  select(from = to, to = from) %>% 
  bind_rows(x %>% select(-dist)) %>% 
  group_by(from) %>% 
  summarize(connections = list(to)) %>% 
  deframe()

bfs <- function(node, visited_small = NULL, part1 = FALSE) {
  # Base case
  if (node == "end") {
    return(list(node))
  }
  # start can't be revisited
  if (node == "start" && "start" %in% visited_small) {
    return(NULL)
  }
  
  if (str_to_upper(node) != node) {
    visited_small <- c(visited_small, node)
  }
  
  possible_next <- connections[[node]]
  
  # part 1 = no revisiting, part 2 = 1 revisit
  if (part1 || any(duplicated(visited_small))) {
    possible_next <- setdiff(possible_next, visited_small)
  }
  
  map(possible_next, bfs, visited_small = visited_small, part = part1) %>% 
    do.call(c, .) %>% 
    map(~ c(node, .))
}




```

Answer #1:
**`r length(bfs("start", part1 = TRUE))`** `r emo::ji("star")`

## Puzzle #2

Answer #1:
**`r length(bfs("start"))`** `r emo::ji("star")`

# Day 13: Transparent Origami

## Puzzle #1

```{r d13-p1, echo = TRUE}
input <- advent_input(13)

folds <- input %>% 
  slice(985:996) %>% 
  mutate(x = str_extract(x, '(x|y)=[0-9]*$')) %>% 
  separate(x, c("direction", "fold"), "=") %>% 
  mutate(fold = parse_number(fold))

points <- input %>% 
  slice(1:983) %>% 
  separate(x, c("x", "y"), convert = TRUE) %>% 
  mutate(y = y * -1)

points %>% 
  ggplot(aes(x, y)) + 
  geom_point() + 
  geom_vline(xintercept = folds$fold[1], color = "red") + 
  coord_fixed()

points2 <- points %>% 
  mutate(f1_x = case_when(x > folds$fold[1] ~ folds$fold[1] - (x - folds$fold[1]),
                        x < folds$fold[1] ~ as.numeric(x)))

points2 %>% 
  ggplot(aes(f1_x, y)) + 
  geom_point()

part1 <- points2 %>% 
  distinct(f1_x, y) %>% 
  count()

```

```{r d13-test, include = FALSE}
test <- data.frame(
                  x = c(6L,0L,9L,0L,10L,4L,6L,
                         6L,4L,0L,10L,3L,3L,8L,1L,2L,8L,9L),
                  y = c(10L,14L,10L,3L,4L,11L,
                         0L,12L,1L,13L,12L,4L,0L,4L,10L,14L,10L,0L)
        ) %>% 
  mutate(x = as.numeric(x), 
         y = as.numeric(y) * -1) %>% 
  mutate(f1_y = case_when(y < -7 ~ -7 + (-7 - y),
                          y > -7 ~ y))

test %>% 
  ggplot(aes(x, y)) + 
  geom_point() + 
  geom_hline(yintercept = -7)


test %>% distinct(x,y) %>% count()

test %>% 
  ggplot(aes(x, f1_y)) + 
  geom_point()

test %>% distinct(x, f1_y) %>% count()
```

Answer #1:
**`r part1`** `r emo::ji("star")`

## Puzzle #2

```{r d13-p2, echo = TRUE}

points2 <- points %>% 
  mutate(x = case_when(x > folds$fold[1] ~ folds$fold[1] - (x - folds$fold[1]),
                        x < folds$fold[1] ~ as.numeric(x)),
         y = case_when(y < -folds$fold[2] ~ -folds$fold[2] + (-folds$fold[2] - y),
                        y > -folds$fold[2] ~ y),
         x = case_when(x > folds$fold[3] ~ folds$fold[3] - (x - folds$fold[3]),
                        x < folds$fold[3] ~ x),
         y = case_when(y < -folds$fold[4] ~ -folds$fold[4] + (-folds$fold[4] - y),
                        y > -folds$fold[4] ~ y),
         x = case_when(x > folds$fold[5] ~ folds$fold[5] - (x - folds$fold[5]),
                        x < folds$fold[5] ~ x),
         y = case_when(y < -folds$fold[6] ~ -folds$fold[6] + (-folds$fold[6] - y),
                        y > -folds$fold[6] ~ y),
         x = case_when(x > folds$fold[7] ~ folds$fold[7] - (x - folds$fold[7]),
                        x < folds$fold[7] ~ x),
         y = case_when(y < -folds$fold[8] ~ -folds$fold[8] + (-folds$fold[8] - y),
                        y > -folds$fold[8] ~ y),
         x = case_when(x > folds$fold[9] ~ folds$fold[9] - (x - folds$fold[9]),
                        x < folds$fold[9] ~ x),
         y = case_when(y < -folds$fold[10] ~ -folds$fold[10] + (-folds$fold[10] - y),
                        y > -folds$fold[10] ~ y),
         y = case_when(y < -folds$fold[11] ~ -folds$fold[11] + (-folds$fold[11] - y),
                        y > -folds$fold[11] ~ y),
         y = case_when(y < -folds$fold[12] ~ -folds$fold[12] + (-folds$fold[12] - y),
                        y > -folds$fold[12] ~ y))


points2 %>% 
  ggplot(aes(x, y)) + 
  geom_tile()


```

Answer #2:
**HLBUBGFR** `r emo::ji("star")`